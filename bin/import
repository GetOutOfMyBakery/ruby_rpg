#!/usr/bin/env ruby

# frozen_string_literal: true

require_relative '../src/engine/engine'
require 'fileutils'

assets_path = ARGV[0]

puts "importing assets from #{assets_path}"
FileUtils.mkdir_p(File.join(assets_path, '_imported'))

fonts = Dir.glob("#{ARGV[0]}/**/*.ttf")
puts "found #{fonts.size} fonts"
fonts.each do |font|
  puts "importing #{font}"
  destination_image = (font.gsub(assets_path, "")).gsub(/\.ttf$/, '.png')
  destination_path = File.join(assets_path, '_imported', destination_image)
  puts "  -> #{destination_path}"
  Engine::Font.new(font).import(destination_path)
end

images = Dir.glob("#{ARGV[0]}/**/*.png")
puts "found #{images.size} images"
images.each do |image|
  puts "importing #{image}"
end
